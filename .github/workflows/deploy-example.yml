# name: Deploy to EC2

# on:
#   pull_request:
#     branches:
#       - main # ou a branch que vocÃª deseja monitorar
#     types: 
#       [closed]


# jobs:
#   deploy:
#     runs-on: ubuntu-latest

#     steps:
#     - name: Checkout Repository
#       uses: actions/checkout@v2

#     - name: Setup Node.js
#       uses: actions/setup-node@v3
#       with:
#         node-version: '14'

#     - name: Install Dependencies
#       run: npm install

#     - name: Deploy to EC2
#       run: |
#         mkdir -p ~/.ssh
#         echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
#         chmod 600 ~/.ssh/id_rsa
#         ssh-keyscan -H ${{ secrets.REMOTE_HOST }} >> ~/.ssh/known_hosts

#         rsync -r --delete-after -e "ssh -i ~/.ssh/id_rsa -o StrictHostKeyChecking=no" ./ ec2-user@ec2-18-218-199-127.us-east-2.compute.amazonaws.com:/home/ec2-user/api-node

#         ssh -i ~/.ssh/id_rsa -o StrictHostKeyChecking=no ec2-user@ec2-18-218-199-127.us-east-2.compute.amazonaws.com 'pm2 restart api-node'